---
import { Image } from 'astro:assets'
import Layout from '../../layouts/Layout.astro'
import CameraRecipe from '../../components/CameraRecipe.astro'
import { projects, getProjectBySlug } from '../../data/projects'
import type { GetStaticPaths } from 'astro'

export const getStaticPaths: GetStaticPaths = async () => {
  return projects.map((project) => ({
    params: { slug: project.slug },
    props: { project },
  }))
}

const { project } = Astro.props
---

<Layout title={`${project.title} — SONDERNISTA`}>
  <div class="pt-28">
    <section class="py-16 md:py-24">
      <div class="max-w-[1400px] mx-auto px-8">
        <!-- Header -->
        <div class="mb-20">
          <a 
            href="/work" 
            class="text-base uppercase tracking-[0.15em] text-secondary hover:text-primary transition-colors"
          >
            ← Back to Work
          </a>
          <h1 class="mt-10 text-2xl sm:text-4xl md:text-5xl uppercase tracking-[0.15em] font-semibold text-primary">
            {project.title}
          </h1>
          <p class="mt-4 text-lg uppercase tracking-[0.15em] text-secondary">
            {project.year}
          </p>
          {project.tags && project.tags.length > 0 && (
            <div class="mt-8 flex flex-wrap gap-3">
              {project.tags.map((tag) => (
                <span class="px-3 py-1 text-xs uppercase tracking-[0.15em] border border-border text-secondary">
                  {tag}
                </span>
              ))}
            </div>
          )}
          <p class="mt-10 max-w-3xl text-lg text-muted-foreground leading-relaxed">
            {project.longDescription}
          </p>
          <CameraRecipe recipe={project.recipe} />
        </div>

        <!-- Gallery -->
        <div class="flex flex-col gap-12">
          {project.gallery.map((image, index) => (
            <div class="border border-border">
              <Image 
                src={image} 
                alt={`${project.title} — ${index + 1}`}
                widths={[800, 1200]}
                sizes="(max-width: 640px) 100vw, (max-width: 1400px) 85vw, 1400px"
                class="w-full max-h-[85vh] object-contain"
                loading={index === 0 ? 'eager' : 'lazy'}
              />
            </div>
          ))}
        </div>

        <!-- Navigation -->
        <div class="mt-28 pt-10 border-t border-border flex justify-between">
          <a 
            href="/work" 
            class="text-base uppercase tracking-[0.15em] text-secondary hover:text-primary transition-colors"
          >
            ← All Projects
          </a>
        </div>
      </div>
    </section>
  </div>
</Layout>
